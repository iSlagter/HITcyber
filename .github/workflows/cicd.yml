
### עדכון קובץ ה-CI/CD:
    name: Trigger auto deployment for HIT Cyber Project
    
    on:
      push:
        branches: 
          - master
      workflow_dispatch:      
    
    jobs:
      build-and-deploy:
        runs-on: ubuntu-latest
        permissions: 
          id-token: write
          contents: read
    
        steps:
          - name: Checkout to the branch
            uses: actions/checkout@v2
    
          - name: Azure Login
            uses: azure/login@v1
            with:
              client-id: ${{ secrets.HITCAPP_AZURE_CLIENT_ID }}
              tenant-id: ${{ secrets.HITCAPP_AZURE_TENANT_ID }}
              subscription-id: ${{ secrets.HITCAPP_AZURE_SUBSCRIPTION_ID }}
    
          - name: Build and push secure container image to ACR
            uses: azure/container-apps-deploy-action@v2
            with:
              appSourcePath: ${{ github.workspace }}/communication_ltd_secure
              registryUrl: hitacr.azurecr.io
              registryUsername: ${{ secrets.HITCAPP_REGISTRY_USERNAME }}
              registryPassword: ${{ secrets.HITCAPP_REGISTRY_PASSWORD }}
              containerAppName: hit-cyber-image-secure
              resourceGroup: HIT
              imageToBuild: hitacr.azurecr.io/hit-cyber-image-secure:${{ github.sha }}
              
          - name: Build and push vulnerable container image to ACR
            uses: azure/container-apps-deploy-action@v2
            with:
              appSourcePath: ${{ github.workspace }}/communication_ltd_vulnerable
              registryUrl: hitacr.azurecr.io
              registryUsername: ${{ secrets.HITCAPP_REGISTRY_USERNAME }}
              registryPassword: ${{ secrets.HITCAPP_REGISTRY_PASSWORD }}
              containerAppName: hit-cyber-image-vulnerable
              resourceGroup: HIT
              imageToBuild: hitacr.azurecr.io/hit-cyber-image-vulnerable:${{ github.sha }}
    